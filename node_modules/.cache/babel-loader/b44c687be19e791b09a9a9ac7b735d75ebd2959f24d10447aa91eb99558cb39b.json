{"ast":null,"code":"/**\n * Generate a printable HTML representation of the simulation results\n * @param {Object} results - The simulation results\n * @param {Function} t - Translation function\n * @returns {String} - HTML content to be printed\n */\nexport const generatePrintableHTML = (results, t) => {\n  var _results$inputs, _results$inputs2, _results$inputs3, _results$inputs4, _results$inputs5, _results$inputs6, _results$inputs7, _results$inputs8, _results$inputs9, _results$inputs0;\n  // Helper function to format numbers with commas as thousands separators\n  const formatNumber = (num, decimals = 0) => {\n    if (typeof num === 'string') return num;\n    return num.toLocaleString(undefined, {\n      minimumFractionDigits: decimals,\n      maximumFractionDigits: decimals\n    });\n  };\n\n  // Helper function to format currency\n  const formatCurrency = (amount, isEstimate = false) => {\n    // Get the current language from the results\n    const currentLang = results.language || 'en';\n\n    // Place the currency symbol after the number for Japanese\n    if (currentLang === 'ja') {\n      return isEstimate ? `役${formatNumber(Math.round(amount))}${t('currency')}` : `${formatNumber(Math.round(amount))}${t('currency')}`;\n    }\n    // Default format for other languages\n    return `${t('currency')} ${formatNumber(Math.round(amount))}`;\n  };\n\n  // Helper function to format percentage\n  const formatPercent = value => {\n    return `${value.toFixed(2)}%`;\n  };\n\n  // Determine the status tag based on payback period\n  let statusInfo = {\n    title: t('excellentInvestment'),\n    backgroundColor: '#4caf50',\n    // Success green\n    color: '#FFFFFF'\n  };\n  if (results.paybackPeriod > 12) {\n    statusInfo = {\n      title: t('considerCarefully'),\n      backgroundColor: '#f44336',\n      // Error red\n      color: '#FFFFFF'\n    };\n  } else if (results.paybackPeriod > 8) {\n    statusInfo = {\n      title: t('goodInvestment'),\n      backgroundColor: '#ff9800',\n      // Warning orange/yellow\n      color: '#FFFFFF'\n    };\n  }\n\n  // Calculate labor cost - this is an estimate\n  const laborCost = (results.costPerUnit || 0) - (((_results$inputs = results.inputs) === null || _results$inputs === void 0 ? void 0 : _results$inputs.materialCostPerUnit) || 0) - (results.inkCostPerUnit || 0);\n\n  // Sample image and caption text\n  const sampleImageCaption = results.language === 'ja' ? '全てのシミュレーションは、この画像を基に算出しています' : 'Simulations are based on the above image';\n\n  // Base64-encoded sample image (this should be replaced with the actual base64 encoding of lisa.png)\n  // For this example we're using a placeholder, but in a production environment this would be \n  // the actual base64 encoding of the Lisa image\n  const imageBase64 = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAEsmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS41LjAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgdGlmZjpJbWFnZVdpZHRoPSIxMjgiCiAgIHRpZmY6SW1hZ2VMZW5ndGg9IjEyOCIKICAgdGlmZjpDb21wcmVzc2lvbj0iMSIKICAgdGlmZjpQaG90b21ldHJpY0ludGVycHJldGF0aW9uPSIyIgogICB0aWZmOk9yaWVudGF0aW9uPSIxIgogICBleGlmOlBpeGVsWERpbWVuc2lvbj0iMTI4IgogICBleGlmOlBpeGVsWURpbWVuc2lvbj0iMTI4IgogICBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIgogICBwaG90b3Nob3A6SUNDUHJvZmlsZT0iRGlzcGxheSBQMy9zcnMtSXNvQ29hdCdiYXNlZCIKICAgeG1wOk1vZGlmeURhdGU9IjIwMjMtMDYtMjNU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';\n\n  // Generate HTML content with 2-column layout and matching color scheme\n  const htmlContent = `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <title>${t('mo180Simulator')} - ${t('simulationResults')}</title>\n      <meta charset=\"UTF-8\">\n      <style>\n        body {\n          font-family: Arial, sans-serif;\n          padding: 20px;\n          max-width: 1000px;\n          margin: 0 auto;\n          color: #333;\n          background-color: #ffffff;\n        }\n        h1, h2, h3 {\n          color: #008d70;\n          margin-top: 0;\n        }\n        .header {\n          border-bottom: 2px solid #008d70;\n          padding-bottom: 10px;\n          margin-bottom: 20px;\n          background-color: #f8f8f8;\n          padding: 20px;\n          border-radius: 8px 8px 0 0;\n        }\n        .header h1 {\n          margin: 0;\n          font-size: 24px;\n        }\n        .header h2 {\n          margin: 5px 0 0 0;\n          font-weight: normal;\n          font-size: 16px;\n          color: #666;\n        }\n        .status-tag {\n          display: inline-block;\n          padding: 6px 16px;\n          border-radius: 24px;\n          font-weight: bold;\n          background-color: ${statusInfo.backgroundColor};\n          color: ${statusInfo.color};\n          font-size: 14px;\n          float: right;\n        }\n        .date {\n          font-size: 14px;\n          color: #777;\n          text-align: right;\n          margin-bottom: 20px;\n        }\n        .content-wrapper {\n          display: flex;\n          flex-direction: row;\n          gap: 30px;\n        }\n        .left-column {\n          flex: 0 0 35%;\n        }\n        .right-column {\n          flex: 0 0 60%;\n        }\n        .card {\n          background-color: #ffffff;\n          border-radius: 8px;\n          box-shadow: 0 2px 10px rgba(0,0,0,0.08);\n          margin-bottom: 24px;\n          overflow: hidden;\n        }\n        .card-header {\n          background-color: #f5f5f5;\n          padding: 12px 16px;\n          border-bottom: 1px solid #e0e0e0;\n        }\n        .card-header h3 {\n          margin: 0;\n          font-size: 16px;\n        }\n        .card-content {\n          padding: 16px;\n        }\n        table {\n          width: 100%;\n          border-collapse: collapse;\n          margin-bottom: 0;\n        }\n        th {\n          background-color: #008d70;\n          color: white;\n          padding: 10px 16px;\n          text-align: left;\n          font-weight: 500;\n          font-size: 14px;\n        }\n        td {\n          padding: 10px 16px;\n          border-bottom: 1px solid #eeeeee;\n          font-size: 14px;\n        }\n        tr:last-child td {\n          border-bottom: none;\n        }\n        tr:nth-child(even) {\n          background-color: #f9f9f9;\n        }\n        .value-cell {\n          text-align: right;\n          font-weight: 500;\n        }\n        .summary-section {\n          background-color: #e8f5e9;\n          border-radius: 8px;\n          padding: 0;\n          margin-bottom: 24px;\n          overflow: hidden;\n          box-shadow: 0 2px 10px rgba(0,0,0,0.08);\n        }\n        .summary-table {\n          border: none;\n          margin-bottom: 0;\n        }\n        .summary-table td {\n          border-bottom: 1px solid #c8e6c9;\n          padding: 14px 16px;\n        }\n        .summary-table tr:last-child td {\n          border-bottom: none;\n        }\n        .summary-header {\n          background-color: #4caf50;\n          color: white;\n          padding: 12px 16px;\n        }\n        .summary-header h3 {\n          margin: 0;\n          color: white;\n          font-size: 16px;\n        }\n        .cyan-accent {\n          border-left: 4px solid #00bcd4;\n        }\n        .magenta-accent {\n          border-left: 4px solid #e91e63;\n        }\n        .yellow-accent {\n          border-left: 4px solid #ffc107;\n        }\n        .footer {\n          margin-top: 30px;\n          text-align: center;\n          color: #777;\n          font-size: 12px;\n          border-top: 1px solid #ddd;\n          padding-top: 10px;\n        }\n        .print-button {\n          background-color: #008d70;\n          color: white;\n          border: none;\n          border-radius: 4px;\n          padding: 12px 24px;\n          font-size: 14px;\n          font-weight: 600;\n          cursor: pointer;\n          box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n          transition: all 0.3s;\n          display: block;\n          margin: 30px auto;\n        }\n        .print-button:hover {\n          background-color: #00755e;\n          box-shadow: 0 4px 8px rgba(0,0,0,0.2);\n        }\n        .text-center {\n          text-align: center;\n        }\n        .sample-image {\n          max-width: 100%;\n          height: auto;\n          border-radius: 8px;\n          margin: 0 auto;\n          display: block;\n          box-shadow: 0 2px 8px rgba(0,0,0,0.15);\n        }\n        @media print {\n          body {\n            padding: 0;\n            background-color: white;\n          }\n          .no-print {\n            display: none;\n          }\n          .content-wrapper {\n            display: flex;\n            flex-direction: row;\n          }\n          .left-column {\n            width: 35%;\n          }\n          .right-column {\n            width: 60%;\n          }\n          .card {\n            box-shadow: none;\n            border: 1px solid #e0e0e0;\n          }\n          .summary-section {\n            box-shadow: none;\n            border: 1px solid #c8e6c9;\n          }\n        }\n      </style>\n    </head>\n    <body>\n      <div class=\"header\">\n        <span class=\"status-tag\">${statusInfo.title}</span>\n        <h1>${t('mo180Simulator')}</h1>\n        <h2>${t('simulationResults')}</h2>\n      </div>\n      \n      <div class=\"date\">\n        ${t('generatedOn')}: ${new Date().toLocaleDateString()}\n      </div>\n      \n      <div class=\"content-wrapper\">\n        <!-- Left column - Input parameters -->\n        <div class=\"left-column\">\n          <!-- Sample Image Card - New -->\n          <div class=\"card cyan-accent\">\n            <div class=\"card-header\">\n              <h3>${results.language === 'ja' ? 'サンプル印刷' : 'Sample Print'}</h3>\n            </div>\n            <div class=\"card-content\">\n              <img src=\"${imageBase64}\" alt=\"Lisa\" class=\"sample-image\" />\n              <p class=\"text-center\" style=\"margin-top: 12px; color: #666; font-size: 14px;\">\n                ${sampleImageCaption}\n              </p>\n            </div>\n          </div>\n        \n          <div class=\"card cyan-accent\">\n            <div class=\"card-header\">\n              <h3>${t('simulationParameters')}</h3>\n            </div>\n            <div class=\"card-content\">\n              <table>\n                <!-- Initial Investment - New -->\n                <tr>\n                  <td>${t('initialInvestment')}</td>\n                  <td class=\"value-cell\">${formatCurrency(((_results$inputs2 = results.inputs) === null || _results$inputs2 === void 0 ? void 0 : _results$inputs2.initialInvestment) || 3780000)}</td>\n                </tr>\n                <tr>\n                  <td>${t('productDimensions')}</td>\n                  <td class=\"value-cell\">${((_results$inputs3 = results.inputs) === null || _results$inputs3 === void 0 ? void 0 : _results$inputs3.shortEdge) || 0} x ${((_results$inputs4 = results.inputs) === null || _results$inputs4 === void 0 ? void 0 : _results$inputs4.longEdge) || 0} mm</td>\n                </tr>\n                <tr>\n                  <td>${t('monthlySalesTarget')}</td>\n                  <td class=\"value-cell\">${formatNumber(((_results$inputs5 = results.inputs) === null || _results$inputs5 === void 0 ? void 0 : _results$inputs5.monthlySalesVolume) || 0)} ${t('units')}</td>\n                </tr>\n                <tr>\n                  <td>${t('salesPricePerUnit')}</td>\n                  <td class=\"value-cell\">${formatCurrency(((_results$inputs6 = results.inputs) === null || _results$inputs6 === void 0 ? void 0 : _results$inputs6.salesPricePerUnit) || 0)}</td>\n                </tr>\n                <tr>\n                  <td>${t('materialCostPerUnit')}</td>\n                  <td class=\"value-cell\">${formatCurrency(((_results$inputs7 = results.inputs) === null || _results$inputs7 === void 0 ? void 0 : _results$inputs7.materialCostPerUnit) || 0)}</td>\n                </tr>\n                <tr>\n                  <td>${t('laborCostPerHour')}</td>\n                  <td class=\"value-cell\">${formatCurrency(((_results$inputs8 = results.inputs) === null || _results$inputs8 === void 0 ? void 0 : _results$inputs8.laborCostPerHour) || 0)}</td>\n                </tr>\n                <tr>\n                  <td>${t('inkPrice')}</td>\n                  <td class=\"value-cell\">${((_results$inputs9 = results.inputs) === null || _results$inputs9 === void 0 ? void 0 : _results$inputs9.inkPricePerCC) || 0} ${t('currency')}/${t('cc')}</td>\n                </tr>\n              </table>\n            </div>\n          </div>\n          \n          <div class=\"card magenta-accent\">\n            <div class=\"card-header\">\n              <h3>${t('inkUsagePerItem')}</h3>\n            </div>\n            <div class=\"card-content\">\n              <table>\n                <tr>\n                  <td>${t('white')}</td>\n                  <td class=\"value-cell\">${results.inkUsage.white} ${t('cc')}</td>\n                </tr>\n                <tr>\n                  <td>${t('cmyk')}</td>\n                  <td class=\"value-cell\">${results.inkUsage.cmyk} ${t('cc')}</td>\n                </tr>\n                <tr>\n                  <td>${t('primer')}</td>\n                  <td class=\"value-cell\">${results.inkUsage.primer} ${t('cc')}</td>\n                </tr>\n                <tr>\n                  <td>${t('inkCostPerUnit')}</td>\n                  <td class=\"value-cell\">${results.language === 'ja' ? formatCurrency(results.inkCostPerUnit, true) : formatCurrency(results.inkCostPerUnit)}</td>\n                </tr>\n              </table>\n            </div>\n          </div>\n        </div>\n        \n        <!-- Right column - Results -->\n        <div class=\"right-column\">\n          <div class=\"summary-section\">\n            <div class=\"summary-header\">\n              <h3>${t('keySummary')}</h3>\n            </div>\n            <table class=\"summary-table\">\n              <tr>\n                <td><strong>${t('monthlySales')}</strong></td>\n                <td class=\"value-cell\"><strong>${formatCurrency(results.monthlySales)}</strong></td>\n              </tr>\n              <tr>\n                <td><strong>${t('monthlyGrossProfit')}</strong></td>\n                <td class=\"value-cell\"><strong>${formatCurrency(results.monthlyGrossProfit)}</strong></td>\n              </tr>\n              <tr>\n                <td><strong>${t('grossProfitMargin')}</strong></td>\n                <td class=\"value-cell\"><strong>${formatPercent(results.grossProfitMargin)}</strong></td>\n              </tr>\n              <tr>\n                <td><strong>${t('investmentPaybackPeriod')}</strong></td>\n                <td class=\"value-cell\"><strong>${results.paybackPeriod === '-' ? 'N/A' : `${results.paybackPeriod.toFixed(1)} ${t('months')}`}</strong></td>\n              </tr>\n            </table>\n          </div>\n          \n          <div class=\"card yellow-accent\">\n            <div class=\"card-header\">\n              <h3>${t('costBreakdownPerUnit')}</h3>\n            </div>\n            <div class=\"card-content\">\n              <table>\n                <tr>\n                  <td>${t('costPerUnit')}</td>\n                  <td class=\"value-cell\">${formatCurrency(results.costPerUnit)}</td>\n                </tr>\n                <tr>\n                  <td>${t('material')}</td>\n                  <td class=\"value-cell\">${formatCurrency(((_results$inputs0 = results.inputs) === null || _results$inputs0 === void 0 ? void 0 : _results$inputs0.materialCostPerUnit) || 0)}</td>\n                </tr>\n                <tr>\n                  <td>${t('ink')}</td>\n                  <td class=\"value-cell\">${results.language === 'ja' ? formatCurrency(results.inkCostPerUnit, true) : formatCurrency(results.inkCostPerUnit)}</td>\n                </tr>\n                <tr>\n                  <td>${t('labor')}</td>\n                  <td class=\"value-cell\">${results.language === 'ja' ? formatCurrency(laborCost, true) : formatCurrency(laborCost)}</td>\n                </tr>\n              </table>\n            </div>\n          </div>\n          \n          <div class=\"card cyan-accent\">\n            <div class=\"card-header\">\n              <h3>${t('productionDetails')}</h3>\n            </div>\n            <div class=\"card-content\">\n              <table>\n                <tr>\n                  <td>${t('operatingHours')}</td>\n                  <td class=\"value-cell\">${results.operatingHours.toFixed(1)} ${t('hours')}</td>\n                </tr>\n                <tr>\n                  <td>${t('itemsPerPrintJob')}</td>\n                  <td class=\"value-cell\">${formatNumber(results.itemsPerPrintJob)} ${t('units')}</td>\n                </tr>\n                <tr>\n                  <td>${t('monthlyPrintJobs')}</td>\n                  <td class=\"value-cell\">${formatNumber(results.monthlyPrintJobs)} ${t('jobs')}</td>\n                </tr>\n              </table>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <div class=\"footer\">\n        Roland DG MO-180 UV Printer | ${t('mo180Simulator')} | ${new Date().toLocaleDateString()}\n      </div>\n      \n      <button class=\"print-button no-print\" onclick=\"window.print()\">\n        ${t('downloadPDF')}\n      </button>\n    </body>\n    </html>\n  `;\n  return htmlContent;\n};\n\n/**\n * Open a new window with printable content\n * @param {Object} results - The simulation results\n * @param {Function} t - Translation function\n */\nexport const printResults = (results, t) => {\n  const html = generatePrintableHTML(results, t);\n  const printWindow = window.open('', '_blank');\n  printWindow.document.write(html);\n  printWindow.document.close();\n  // The user can click the print button in the new window\n};\nexport default printResults;","map":{"version":3,"names":["generatePrintableHTML","results","t","_results$inputs","_results$inputs2","_results$inputs3","_results$inputs4","_results$inputs5","_results$inputs6","_results$inputs7","_results$inputs8","_results$inputs9","_results$inputs0","formatNumber","num","decimals","toLocaleString","undefined","minimumFractionDigits","maximumFractionDigits","formatCurrency","amount","isEstimate","currentLang","language","Math","round","formatPercent","value","toFixed","statusInfo","title","backgroundColor","color","paybackPeriod","laborCost","costPerUnit","inputs","materialCostPerUnit","inkCostPerUnit","sampleImageCaption","imageBase64","htmlContent","Date","toLocaleDateString","initialInvestment","shortEdge","longEdge","monthlySalesVolume","salesPricePerUnit","laborCostPerHour","inkPricePerCC","inkUsage","white","cmyk","primer","monthlySales","monthlyGrossProfit","grossProfitMargin","operatingHours","itemsPerPrintJob","monthlyPrintJobs","printResults","html","printWindow","window","open","document","write","close"],"sources":["/Users/nicholasgobert/Desktop/Apps/MOSimulator/src/utils/pdf/generatePDF.js"],"sourcesContent":["/**\n * Generate a printable HTML representation of the simulation results\n * @param {Object} results - The simulation results\n * @param {Function} t - Translation function\n * @returns {String} - HTML content to be printed\n */\nexport const generatePrintableHTML = (results, t) => {\n  // Helper function to format numbers with commas as thousands separators\n  const formatNumber = (num, decimals = 0) => {\n    if (typeof num === 'string') return num;\n    return num.toLocaleString(undefined, { \n      minimumFractionDigits: decimals,\n      maximumFractionDigits: decimals\n    });\n  };\n\n  // Helper function to format currency\n  const formatCurrency = (amount, isEstimate = false) => {\n    // Get the current language from the results\n    const currentLang = results.language || 'en';\n    \n    // Place the currency symbol after the number for Japanese\n    if (currentLang === 'ja') {\n      return isEstimate \n        ? `役${formatNumber(Math.round(amount))}${t('currency')}` \n        : `${formatNumber(Math.round(amount))}${t('currency')}`;\n    }\n    // Default format for other languages\n    return `${t('currency')} ${formatNumber(Math.round(amount))}`;\n  };\n\n  // Helper function to format percentage\n  const formatPercent = (value) => {\n    return `${value.toFixed(2)}%`;\n  };\n\n  // Determine the status tag based on payback period\n  let statusInfo = {\n    title: t('excellentInvestment'),\n    backgroundColor: '#4caf50', // Success green\n    color: '#FFFFFF'\n  };\n\n  if (results.paybackPeriod > 12) {\n    statusInfo = {\n      title: t('considerCarefully'),\n      backgroundColor: '#f44336', // Error red\n      color: '#FFFFFF'\n    };\n  } else if (results.paybackPeriod > 8) {\n    statusInfo = {\n      title: t('goodInvestment'),\n      backgroundColor: '#ff9800', // Warning orange/yellow\n      color: '#FFFFFF'\n    };\n  }\n\n  // Calculate labor cost - this is an estimate\n  const laborCost = (results.costPerUnit || 0) - (results.inputs?.materialCostPerUnit || 0) - (results.inkCostPerUnit || 0);\n\n  // Sample image and caption text\n  const sampleImageCaption = results.language === 'ja'\n    ? '全てのシミュレーションは、この画像を基に算出しています'\n    : 'Simulations are based on the above image';\n\n  // Base64-encoded sample image (this should be replaced with the actual base64 encoding of lisa.png)\n  // For this example we're using a placeholder, but in a production environment this would be \n  // the actual base64 encoding of the Lisa image\n  const imageBase64 = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAEsmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS41LjAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgdGlmZjpJbWFnZVdpZHRoPSIxMjgiCiAgIHRpZmY6SW1hZ2VMZW5ndGg9IjEyOCIKICAgdGlmZjpDb21wcmVzc2lvbj0iMSIKICAgdGlmZjpQaG90b21ldHJpY0ludGVycHJldGF0aW9uPSIyIgogICB0aWZmOk9yaWVudGF0aW9uPSIxIgogICBleGlmOlBpeGVsWERpbWVuc2lvbj0iMTI4IgogICBleGlmOlBpeGVsWURpbWVuc2lvbj0iMTI4IgogICBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIgogICBwaG90b3Nob3A6SUNDUHJvZmlsZT0iRGlzcGxheSBQMy9zcnMtSXNvQ29hdCdiYXNlZCIKICAgeG1wOk1vZGlmeURhdGU9IjIwMjMtMDYtMjNU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';\n\n  // Generate HTML content with 2-column layout and matching color scheme\n  const htmlContent = `\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <title>${t('mo180Simulator')} - ${t('simulationResults')}</title>\n      <meta charset=\"UTF-8\">\n      <style>\n        body {\n          font-family: Arial, sans-serif;\n          padding: 20px;\n          max-width: 1000px;\n          margin: 0 auto;\n          color: #333;\n          background-color: #ffffff;\n        }\n        h1, h2, h3 {\n          color: #008d70;\n          margin-top: 0;\n        }\n        .header {\n          border-bottom: 2px solid #008d70;\n          padding-bottom: 10px;\n          margin-bottom: 20px;\n          background-color: #f8f8f8;\n          padding: 20px;\n          border-radius: 8px 8px 0 0;\n        }\n        .header h1 {\n          margin: 0;\n          font-size: 24px;\n        }\n        .header h2 {\n          margin: 5px 0 0 0;\n          font-weight: normal;\n          font-size: 16px;\n          color: #666;\n        }\n        .status-tag {\n          display: inline-block;\n          padding: 6px 16px;\n          border-radius: 24px;\n          font-weight: bold;\n          background-color: ${statusInfo.backgroundColor};\n          color: ${statusInfo.color};\n          font-size: 14px;\n          float: right;\n        }\n        .date {\n          font-size: 14px;\n          color: #777;\n          text-align: right;\n          margin-bottom: 20px;\n        }\n        .content-wrapper {\n          display: flex;\n          flex-direction: row;\n          gap: 30px;\n        }\n        .left-column {\n          flex: 0 0 35%;\n        }\n        .right-column {\n          flex: 0 0 60%;\n        }\n        .card {\n          background-color: #ffffff;\n          border-radius: 8px;\n          box-shadow: 0 2px 10px rgba(0,0,0,0.08);\n          margin-bottom: 24px;\n          overflow: hidden;\n        }\n        .card-header {\n          background-color: #f5f5f5;\n          padding: 12px 16px;\n          border-bottom: 1px solid #e0e0e0;\n        }\n        .card-header h3 {\n          margin: 0;\n          font-size: 16px;\n        }\n        .card-content {\n          padding: 16px;\n        }\n        table {\n          width: 100%;\n          border-collapse: collapse;\n          margin-bottom: 0;\n        }\n        th {\n          background-color: #008d70;\n          color: white;\n          padding: 10px 16px;\n          text-align: left;\n          font-weight: 500;\n          font-size: 14px;\n        }\n        td {\n          padding: 10px 16px;\n          border-bottom: 1px solid #eeeeee;\n          font-size: 14px;\n        }\n        tr:last-child td {\n          border-bottom: none;\n        }\n        tr:nth-child(even) {\n          background-color: #f9f9f9;\n        }\n        .value-cell {\n          text-align: right;\n          font-weight: 500;\n        }\n        .summary-section {\n          background-color: #e8f5e9;\n          border-radius: 8px;\n          padding: 0;\n          margin-bottom: 24px;\n          overflow: hidden;\n          box-shadow: 0 2px 10px rgba(0,0,0,0.08);\n        }\n        .summary-table {\n          border: none;\n          margin-bottom: 0;\n        }\n        .summary-table td {\n          border-bottom: 1px solid #c8e6c9;\n          padding: 14px 16px;\n        }\n        .summary-table tr:last-child td {\n          border-bottom: none;\n        }\n        .summary-header {\n          background-color: #4caf50;\n          color: white;\n          padding: 12px 16px;\n        }\n        .summary-header h3 {\n          margin: 0;\n          color: white;\n          font-size: 16px;\n        }\n        .cyan-accent {\n          border-left: 4px solid #00bcd4;\n        }\n        .magenta-accent {\n          border-left: 4px solid #e91e63;\n        }\n        .yellow-accent {\n          border-left: 4px solid #ffc107;\n        }\n        .footer {\n          margin-top: 30px;\n          text-align: center;\n          color: #777;\n          font-size: 12px;\n          border-top: 1px solid #ddd;\n          padding-top: 10px;\n        }\n        .print-button {\n          background-color: #008d70;\n          color: white;\n          border: none;\n          border-radius: 4px;\n          padding: 12px 24px;\n          font-size: 14px;\n          font-weight: 600;\n          cursor: pointer;\n          box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n          transition: all 0.3s;\n          display: block;\n          margin: 30px auto;\n        }\n        .print-button:hover {\n          background-color: #00755e;\n          box-shadow: 0 4px 8px rgba(0,0,0,0.2);\n        }\n        .text-center {\n          text-align: center;\n        }\n        .sample-image {\n          max-width: 100%;\n          height: auto;\n          border-radius: 8px;\n          margin: 0 auto;\n          display: block;\n          box-shadow: 0 2px 8px rgba(0,0,0,0.15);\n        }\n        @media print {\n          body {\n            padding: 0;\n            background-color: white;\n          }\n          .no-print {\n            display: none;\n          }\n          .content-wrapper {\n            display: flex;\n            flex-direction: row;\n          }\n          .left-column {\n            width: 35%;\n          }\n          .right-column {\n            width: 60%;\n          }\n          .card {\n            box-shadow: none;\n            border: 1px solid #e0e0e0;\n          }\n          .summary-section {\n            box-shadow: none;\n            border: 1px solid #c8e6c9;\n          }\n        }\n      </style>\n    </head>\n    <body>\n      <div class=\"header\">\n        <span class=\"status-tag\">${statusInfo.title}</span>\n        <h1>${t('mo180Simulator')}</h1>\n        <h2>${t('simulationResults')}</h2>\n      </div>\n      \n      <div class=\"date\">\n        ${t('generatedOn')}: ${new Date().toLocaleDateString()}\n      </div>\n      \n      <div class=\"content-wrapper\">\n        <!-- Left column - Input parameters -->\n        <div class=\"left-column\">\n          <!-- Sample Image Card - New -->\n          <div class=\"card cyan-accent\">\n            <div class=\"card-header\">\n              <h3>${results.language === 'ja' ? 'サンプル印刷' : 'Sample Print'}</h3>\n            </div>\n            <div class=\"card-content\">\n              <img src=\"${imageBase64}\" alt=\"Lisa\" class=\"sample-image\" />\n              <p class=\"text-center\" style=\"margin-top: 12px; color: #666; font-size: 14px;\">\n                ${sampleImageCaption}\n              </p>\n            </div>\n          </div>\n        \n          <div class=\"card cyan-accent\">\n            <div class=\"card-header\">\n              <h3>${t('simulationParameters')}</h3>\n            </div>\n            <div class=\"card-content\">\n              <table>\n                <!-- Initial Investment - New -->\n                <tr>\n                  <td>${t('initialInvestment')}</td>\n                  <td class=\"value-cell\">${formatCurrency(results.inputs?.initialInvestment || 3780000)}</td>\n                </tr>\n                <tr>\n                  <td>${t('productDimensions')}</td>\n                  <td class=\"value-cell\">${results.inputs?.shortEdge || 0} x ${results.inputs?.longEdge || 0} mm</td>\n                </tr>\n                <tr>\n                  <td>${t('monthlySalesTarget')}</td>\n                  <td class=\"value-cell\">${formatNumber(results.inputs?.monthlySalesVolume || 0)} ${t('units')}</td>\n                </tr>\n                <tr>\n                  <td>${t('salesPricePerUnit')}</td>\n                  <td class=\"value-cell\">${formatCurrency(results.inputs?.salesPricePerUnit || 0)}</td>\n                </tr>\n                <tr>\n                  <td>${t('materialCostPerUnit')}</td>\n                  <td class=\"value-cell\">${formatCurrency(results.inputs?.materialCostPerUnit || 0)}</td>\n                </tr>\n                <tr>\n                  <td>${t('laborCostPerHour')}</td>\n                  <td class=\"value-cell\">${formatCurrency(results.inputs?.laborCostPerHour || 0)}</td>\n                </tr>\n                <tr>\n                  <td>${t('inkPrice')}</td>\n                  <td class=\"value-cell\">${results.inputs?.inkPricePerCC || 0} ${t('currency')}/${t('cc')}</td>\n                </tr>\n              </table>\n            </div>\n          </div>\n          \n          <div class=\"card magenta-accent\">\n            <div class=\"card-header\">\n              <h3>${t('inkUsagePerItem')}</h3>\n            </div>\n            <div class=\"card-content\">\n              <table>\n                <tr>\n                  <td>${t('white')}</td>\n                  <td class=\"value-cell\">${results.inkUsage.white} ${t('cc')}</td>\n                </tr>\n                <tr>\n                  <td>${t('cmyk')}</td>\n                  <td class=\"value-cell\">${results.inkUsage.cmyk} ${t('cc')}</td>\n                </tr>\n                <tr>\n                  <td>${t('primer')}</td>\n                  <td class=\"value-cell\">${results.inkUsage.primer} ${t('cc')}</td>\n                </tr>\n                <tr>\n                  <td>${t('inkCostPerUnit')}</td>\n                  <td class=\"value-cell\">${results.language === 'ja' ? formatCurrency(results.inkCostPerUnit, true) : formatCurrency(results.inkCostPerUnit)}</td>\n                </tr>\n              </table>\n            </div>\n          </div>\n        </div>\n        \n        <!-- Right column - Results -->\n        <div class=\"right-column\">\n          <div class=\"summary-section\">\n            <div class=\"summary-header\">\n              <h3>${t('keySummary')}</h3>\n            </div>\n            <table class=\"summary-table\">\n              <tr>\n                <td><strong>${t('monthlySales')}</strong></td>\n                <td class=\"value-cell\"><strong>${formatCurrency(results.monthlySales)}</strong></td>\n              </tr>\n              <tr>\n                <td><strong>${t('monthlyGrossProfit')}</strong></td>\n                <td class=\"value-cell\"><strong>${formatCurrency(results.monthlyGrossProfit)}</strong></td>\n              </tr>\n              <tr>\n                <td><strong>${t('grossProfitMargin')}</strong></td>\n                <td class=\"value-cell\"><strong>${formatPercent(results.grossProfitMargin)}</strong></td>\n              </tr>\n              <tr>\n                <td><strong>${t('investmentPaybackPeriod')}</strong></td>\n                <td class=\"value-cell\"><strong>${results.paybackPeriod === '-' ? 'N/A' : `${results.paybackPeriod.toFixed(1)} ${t('months')}`}</strong></td>\n              </tr>\n            </table>\n          </div>\n          \n          <div class=\"card yellow-accent\">\n            <div class=\"card-header\">\n              <h3>${t('costBreakdownPerUnit')}</h3>\n            </div>\n            <div class=\"card-content\">\n              <table>\n                <tr>\n                  <td>${t('costPerUnit')}</td>\n                  <td class=\"value-cell\">${formatCurrency(results.costPerUnit)}</td>\n                </tr>\n                <tr>\n                  <td>${t('material')}</td>\n                  <td class=\"value-cell\">${formatCurrency(results.inputs?.materialCostPerUnit || 0)}</td>\n                </tr>\n                <tr>\n                  <td>${t('ink')}</td>\n                  <td class=\"value-cell\">${results.language === 'ja' ? formatCurrency(results.inkCostPerUnit, true) : formatCurrency(results.inkCostPerUnit)}</td>\n                </tr>\n                <tr>\n                  <td>${t('labor')}</td>\n                  <td class=\"value-cell\">${results.language === 'ja' ? formatCurrency(laborCost, true) : formatCurrency(laborCost)}</td>\n                </tr>\n              </table>\n            </div>\n          </div>\n          \n          <div class=\"card cyan-accent\">\n            <div class=\"card-header\">\n              <h3>${t('productionDetails')}</h3>\n            </div>\n            <div class=\"card-content\">\n              <table>\n                <tr>\n                  <td>${t('operatingHours')}</td>\n                  <td class=\"value-cell\">${results.operatingHours.toFixed(1)} ${t('hours')}</td>\n                </tr>\n                <tr>\n                  <td>${t('itemsPerPrintJob')}</td>\n                  <td class=\"value-cell\">${formatNumber(results.itemsPerPrintJob)} ${t('units')}</td>\n                </tr>\n                <tr>\n                  <td>${t('monthlyPrintJobs')}</td>\n                  <td class=\"value-cell\">${formatNumber(results.monthlyPrintJobs)} ${t('jobs')}</td>\n                </tr>\n              </table>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <div class=\"footer\">\n        Roland DG MO-180 UV Printer | ${t('mo180Simulator')} | ${new Date().toLocaleDateString()}\n      </div>\n      \n      <button class=\"print-button no-print\" onclick=\"window.print()\">\n        ${t('downloadPDF')}\n      </button>\n    </body>\n    </html>\n  `;\n\n  return htmlContent;\n};\n\n/**\n * Open a new window with printable content\n * @param {Object} results - The simulation results\n * @param {Function} t - Translation function\n */\nexport const printResults = (results, t) => {\n  const html = generatePrintableHTML(results, t);\n  const printWindow = window.open('', '_blank');\n  printWindow.document.write(html);\n  printWindow.document.close();\n  // The user can click the print button in the new window\n};\n\nexport default printResults;\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,MAAMA,qBAAqB,GAAGA,CAACC,OAAO,EAAEC,CAAC,KAAK;EAAA,IAAAC,eAAA,EAAAC,gBAAA,EAAAC,gBAAA,EAAAC,gBAAA,EAAAC,gBAAA,EAAAC,gBAAA,EAAAC,gBAAA,EAAAC,gBAAA,EAAAC,gBAAA,EAAAC,gBAAA;EACnD;EACA,MAAMC,YAAY,GAAGA,CAACC,GAAG,EAAEC,QAAQ,GAAG,CAAC,KAAK;IAC1C,IAAI,OAAOD,GAAG,KAAK,QAAQ,EAAE,OAAOA,GAAG;IACvC,OAAOA,GAAG,CAACE,cAAc,CAACC,SAAS,EAAE;MACnCC,qBAAqB,EAAEH,QAAQ;MAC/BI,qBAAqB,EAAEJ;IACzB,CAAC,CAAC;EACJ,CAAC;;EAED;EACA,MAAMK,cAAc,GAAGA,CAACC,MAAM,EAAEC,UAAU,GAAG,KAAK,KAAK;IACrD;IACA,MAAMC,WAAW,GAAGtB,OAAO,CAACuB,QAAQ,IAAI,IAAI;;IAE5C;IACA,IAAID,WAAW,KAAK,IAAI,EAAE;MACxB,OAAOD,UAAU,GACb,IAAIT,YAAY,CAACY,IAAI,CAACC,KAAK,CAACL,MAAM,CAAC,CAAC,GAAGnB,CAAC,CAAC,UAAU,CAAC,EAAE,GACtD,GAAGW,YAAY,CAACY,IAAI,CAACC,KAAK,CAACL,MAAM,CAAC,CAAC,GAAGnB,CAAC,CAAC,UAAU,CAAC,EAAE;IAC3D;IACA;IACA,OAAO,GAAGA,CAAC,CAAC,UAAU,CAAC,IAAIW,YAAY,CAACY,IAAI,CAACC,KAAK,CAACL,MAAM,CAAC,CAAC,EAAE;EAC/D,CAAC;;EAED;EACA,MAAMM,aAAa,GAAIC,KAAK,IAAK;IAC/B,OAAO,GAAGA,KAAK,CAACC,OAAO,CAAC,CAAC,CAAC,GAAG;EAC/B,CAAC;;EAED;EACA,IAAIC,UAAU,GAAG;IACfC,KAAK,EAAE7B,CAAC,CAAC,qBAAqB,CAAC;IAC/B8B,eAAe,EAAE,SAAS;IAAE;IAC5BC,KAAK,EAAE;EACT,CAAC;EAED,IAAIhC,OAAO,CAACiC,aAAa,GAAG,EAAE,EAAE;IAC9BJ,UAAU,GAAG;MACXC,KAAK,EAAE7B,CAAC,CAAC,mBAAmB,CAAC;MAC7B8B,eAAe,EAAE,SAAS;MAAE;MAC5BC,KAAK,EAAE;IACT,CAAC;EACH,CAAC,MAAM,IAAIhC,OAAO,CAACiC,aAAa,GAAG,CAAC,EAAE;IACpCJ,UAAU,GAAG;MACXC,KAAK,EAAE7B,CAAC,CAAC,gBAAgB,CAAC;MAC1B8B,eAAe,EAAE,SAAS;MAAE;MAC5BC,KAAK,EAAE;IACT,CAAC;EACH;;EAEA;EACA,MAAME,SAAS,GAAG,CAAClC,OAAO,CAACmC,WAAW,IAAI,CAAC,KAAK,EAAAjC,eAAA,GAAAF,OAAO,CAACoC,MAAM,cAAAlC,eAAA,uBAAdA,eAAA,CAAgBmC,mBAAmB,KAAI,CAAC,CAAC,IAAIrC,OAAO,CAACsC,cAAc,IAAI,CAAC,CAAC;;EAEzH;EACA,MAAMC,kBAAkB,GAAGvC,OAAO,CAACuB,QAAQ,KAAK,IAAI,GAChD,6BAA6B,GAC7B,0CAA0C;;EAE9C;EACA;EACA;EACA,MAAMiB,WAAW,GAAG,4tdAA4td;;EAEhvd;EACA,MAAMC,WAAW,GAAG;AACtB;AACA;AACA;AACA,eAAexC,CAAC,CAAC,gBAAgB,CAAC,MAAMA,CAAC,CAAC,mBAAmB,CAAC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B4B,UAAU,CAACE,eAAe;AACxD,mBAAmBF,UAAU,CAACG,KAAK;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmCH,UAAU,CAACC,KAAK;AACnD,cAAc7B,CAAC,CAAC,gBAAgB,CAAC;AACjC,cAAcA,CAAC,CAAC,mBAAmB,CAAC;AACpC;AACA;AACA;AACA,UAAUA,CAAC,CAAC,aAAa,CAAC,KAAK,IAAIyC,IAAI,CAAC,CAAC,CAACC,kBAAkB,CAAC,CAAC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB3C,OAAO,CAACuB,QAAQ,KAAK,IAAI,GAAG,QAAQ,GAAG,cAAc;AACzE;AACA;AACA,0BAA0BiB,WAAW;AACrC;AACA,kBAAkBD,kBAAkB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoBtC,CAAC,CAAC,sBAAsB,CAAC;AAC7C;AACA;AACA;AACA;AACA;AACA,wBAAwBA,CAAC,CAAC,mBAAmB,CAAC;AAC9C,2CAA2CkB,cAAc,CAAC,EAAAhB,gBAAA,GAAAH,OAAO,CAACoC,MAAM,cAAAjC,gBAAA,uBAAdA,gBAAA,CAAgByC,iBAAiB,KAAI,O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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}